!function(){for(var i=window.location.host,s={callbacks:{},send:function(e,t){this.dispatchMessage("event",e,t)},sendCallback:function(e){var t=Jockey.createEnvelope(e);this.dispatchMessage("callback",t,function(){})},triggerCallback:function(e,t){var n=this;setTimeout(function(){n.callbacks[e](t)},0)},dispatchMessage:function(n,t,i){var s=this;this.callbacks[t.id]=function(e){i(e),delete s.callbacks[t.id]};var a="jockey://"+n+"/"+t.id+"?"+encodeURIComponent(JSON.stringify(t)),e=document.createElement("iframe");e.setAttribute("src",a),document.documentElement.appendChild(e),e.parentNode.removeChild(e),e=null}},Jockey={listeners:{},dispatcher:null,messageCount:0,on:function(e,t){this.listeners.hasOwnProperty(e)&&this.listeners[e]instanceof Array||(this.listeners[e]=[]),this.listeners[e].push(t)},off:function(e){this.listeners.hasOwnProperty(e)&&this.listeners[e]instanceof Array||(this.listeners[e]=[]),this.listeners[e]=[]},send:function(n,e,t){e instanceof Function&&(t=e,e=null),e=e||{},t=t||function(){};var i=this.createEnvelope(this.messageCount,n,e);this.dispatcher.send(i,t),this.messageCount+=1},trigger:function(r,o,i){for(var c=this,e=this.listeners[r]||[],s=0,a=function(){s+=1,s>=e.length&&c.dispatcher.sendCallback(o)},t=0;t<e.length;t++){var n=e[t];n.length<=1?(n(i),a()):n(i,a)}},triggerCallback:function(t){var e=JSON.parse(t);this.dispatcher.triggerCallback(e.messageId,e.data)},createEnvelope:function(e,t,n){return{id:e,type:t,host:i,payload:n}}},a={send:function(t,e){e()},triggerCallback:function(){},sendCallback:function(){}},e=0,t=!1,n=["iPad","iPhone","iPod"];e<n.length;e++)if(navigator.platform.indexOf(n[e])>=0){t=!0;break}var r=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent),o=navigator.userAgent.toLowerCase().indexOf("android")>-1;t&&r||o?Jockey.dispatcher=s:Jockey.dispatcher=a,window.Jockey=Jockey}();
//# sourceMappingURL=jockey.min.map